(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const b of s.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&a(b)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();const l=document.getElementById("gameCanvas"),c=l.getContext("2d"),o=22,f=15;let d=[{x:10,y:10,visualX:10,visualY:10}],n={x:0,y:0},h={x:Math.floor(Math.random()*f),y:Math.floor(Math.random()*f)},m=0,E=125,u=!1,D=!1,y=!1,x=[];function S(){u&&(X(),Y(),setTimeout(S,p))}function N(){if(x=[],document.getElementById("difficulty").value==="hard")for(let e=0;e<2;e++){let r;do r={x:Math.floor(Math.random()*(f-4))+2,y:Math.floor(Math.random()*(f-4))+2,length:Math.floor(Math.random()*3)+3,isVertical:Math.random()<.5};while(V(r));x.push(r)}}function V(e){for(const t of d)if(Math.abs(e.x-t.x)<4&&Math.abs(e.y-t.y)<4)return!0;return Math.abs(e.x-h.x)<4&&Math.abs(e.y-h.y)<4?!0:x.some(t=>{if(e.isVertical===t.isVertical)return e.isVertical?Math.abs(e.x-t.x)<4&&Math.abs(e.y-t.y)<e.length+t.length:Math.abs(e.y-t.y)<4&&Math.abs(e.x-t.x)<e.length+t.length;{const a=e.isVertical?e.y+e.length:e.x+e.length,i=t.isVertical?t.y+t.length:t.x+t.length;return e.isVertical?Math.abs(e.x-t.x)<4&&e.y<i&&t.y<a:Math.abs(e.y-t.y)<4&&e.x<i&&t.x<a}})}function X(){if(!y)return;const e={x:d[0].x+n.x,y:d[0].y+n.y};if(e.x<0||e.x>=f||e.y<0||e.y>=f||d.some(t=>t.x===e.x&&t.y===e.y)||x.some(t=>t.isVertical?e.x===t.x&&e.y>=t.y&&e.y<t.y+t.length:e.y===t.y&&e.x>=t.x&&e.x<t.x+t.length)){F();return}e.visualX=e.x,e.visualY=e.y,d.unshift(e);const r=.25;if(d.forEach(t=>{t.visualX!==t.x&&(t.visualX+=(t.x-t.visualX)*r),t.visualY!==t.y&&(t.visualY+=(t.y-t.visualY)*r)}),e.x===h.x&&e.y===h.y){m++,document.getElementById("scoreValue").textContent=m;let t;do t={x:Math.floor(Math.random()*f),y:Math.floor(Math.random()*f)};while(d.some(a=>a.x===t.x&&a.y===t.y)||x.some(a=>a.isVertical?t.x===a.x&&t.y>=a.y&&t.y<a.y+a.length:t.y===a.y&&t.x>=a.x&&t.x<a.x+a.length));h=t}else d.pop()}const M=new Image,A=new Image,P=new Image,v=new Image,C=new Image;Promise.all([new Promise(e=>{M.onload=e}),new Promise(e=>{A.onload=e}),new Promise(e=>{P.onload=e}),new Promise(e=>{v.onload=e}),new Promise(e=>{C.onload=e})]).then(()=>{D=!0,g.disabled=!1});M.src="images/drago.png";A.src="images/dragon2-3.png";P.src="images/dragonsnek (3).gif";v.src="images/wall.png";C.src="images/floor.jpg";function Y(){if(c.drawImage(C,0,0,l.width,l.height),x.forEach(e=>{if(e.isVertical)for(let r=0;r<e.length;r++)c.drawImage(v,e.x*o,(e.y+r)*o,o,o);else for(let r=0;r<e.length;r++)c.drawImage(v,(e.x+r)*o,e.y*o,o,o)}),!y&&d.length>0){const e=d[0];c.save(),c.translate(e.x*o+o/2,e.y*o+o/2),c.rotate(Math.PI*1.5),c.drawImage(M,-22/2,-22/2,o,o),c.restore()}d.forEach((e,r)=>{if(c.save(),r===0){let t=Math.PI*1.5;n.x===1?t=Math.PI*1.5:n.x===-1?t=Math.PI*.5:n.y===-1?t=Math.PI:n.y===1&&(t=0),c.translate(e.visualX*o+o/2,e.visualY*o+o/2),c.rotate(t),c.drawImage(M,-22/2,-22/2,o,o)}else{const t=d[r-1],a=e.x-t.x,i=e.y-t.y;let s=0;a===1?s=Math.PI/2:a===-1?s=-Math.PI/2:i===-1?s=0:i===1&&(s=Math.PI),c.translate(e.visualX*o+o/2,e.visualY*o+o/2),c.rotate(s),c.drawImage(A,-22/2,-22/2,o,o)}c.restore()}),c.drawImage(P,h.x*o,h.y*o,o,o)}function F(){u=!1,g.disabled=!1,I.disabled=!0,document.getElementById("scoreValue").textContent=`${m} (Game Over!)`}const g=document.getElementById("startButton"),I=document.getElementById("pauseButton");let p=E;function B(){switch(document.getElementById("difficulty").value){case"easy":p=E*1.2;break;case"hard":p=E*.95;break;default:p=E}N()}document.getElementById("difficulty").addEventListener("change",()=>{B()});g.addEventListener("click",()=>{D&&(d=[{x:10,y:10}],n={x:0,y:0},m=0,y=!1,B(),N(),document.getElementById("scoreValue").textContent=m,u=!0,g.disabled=!0,I.disabled=!1,S())});I.addEventListener("click",()=>{u&&(u=!u,I.textContent=u?"Pause":"Resume",u&&S())});g.disabled=!0;I.disabled=!0;let k=0,T=0;const L=30;document.addEventListener("touchstart",e=>{k=e.touches[0].clientX,T=e.touches[0].clientY});document.addEventListener("touchmove",e=>{e.preventDefault()},{passive:!1});document.addEventListener("touchend",e=>{if(!u)return;const r=e.changedTouches[0].clientX,t=e.changedTouches[0].clientY,a=r-k,i=t-T;if(Math.abs(a)<L&&Math.abs(i)<L)return;let s={...n};Math.abs(a)>Math.abs(i)?a>0&&n.x===0?s={x:1,y:0}:a<0&&n.x===0&&(s={x:-1,y:0}):i>0&&n.y===0?s={x:0,y:1}:i<0&&n.y===0&&(s={x:0,y:-1}),!y&&(s.x!==0||s.y!==0)&&(y=!0),n=s});const _=document.querySelectorAll(".d-pad button");_.forEach(e=>{e.addEventListener("click",()=>{if(!u)return;let r={...n};switch(e.className){case"up":n.y===0&&(r={x:0,y:-1});break;case"down":n.y===0&&(r={x:0,y:1});break;case"left":n.x===0&&(r={x:-1,y:0});break;case"right":n.x===0&&(r={x:1,y:0});break}!y&&(r.x!==0||r.y!==0)&&(y=!0),n=r})});document.addEventListener("keydown",e=>{if(!u)return;let r={...n};switch(e.key){case"ArrowUp":n.y===0&&(r={x:0,y:-1});break;case"ArrowDown":n.y===0&&(r={x:0,y:1});break;case"ArrowLeft":n.x===0&&(r={x:-1,y:0});break;case"ArrowRight":n.x===0&&(r={x:1,y:0});break}!y&&(r.x!==0||r.y!==0)&&(y=!0),n=r});l.width=f*o;l.height=f*o;
